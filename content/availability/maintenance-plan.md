---
title: "镜像站维护方案"
date: 2017-11-20T00:00:00+08:00
---

本镜像站在维护期间采用了多种措施保障用户正常使用各类软件库。

在运营之初，本站主要提供具备自动镜像配置功能的软件库镜像服务，如：CentOS、EPEL、IUS等。这些软件库镜像无需用户手动配置，在使用过程中会自动寻找用户访问速度镜像节点。针对这类镜像，我们会在维护前的1到2天向软件库官方提出申请，临时从自动配置列表中移除本站。在维护期间，用户请求会被自动引导至其他镜像站点，不会对用户正常使用造成影响。

例如，11月19日的维护计划中，我们提前两天申请从自动配置列表中移除本站。从下图的镜像站流量监控中，可以看到出站流量在操作后缓慢降到0附近。在执行维护前，我们会再次检查流量监控，确保基本没有请求后再执行维护。在维护结束后，我们会先确认镜像站能正常对外提供服务，再向自动配置列表中添加本站。整个维护过程对用户基本没有造成影响。

![2017-11-19-maintenance-network](2017-11-19-maintenance-network.jpg)

此外，我们还会提前在镜像站首页发布维护通知，让一部分使用手动配置的用户能够提前做好准备。

随着，镜像站支持的软件库越来越多，其中会有相当一部分软件库不支持自动镜像配置。为了避免维护对用户正常使用造成影响，我们对镜像站维护方案做了进一步调整。从2017年11月20日起，镜像站后续维护将按照下面的维护方案执行。

1. 在镜像站首页、微信公众号上提前发布维护通知，短时间维护（预计耗时在30分钟内）至少提前3天通知，长时间维护（预计耗时超过1个小时）至少提前7天通知；
2. 提前1到2天逐步从自动镜像配置列表中移除本站；
3. 提前1小时将域名解析至备用服务器，通过备用服务器将不支持自动镜像配置的软件库请求重定向至其他镜像站点。